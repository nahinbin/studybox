{% extends "base.html" %}

{% block title %}StudyBox - Register{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <div class="card">
                <div class="card-body">
                    <h2 class="card-title text-center mb-4">Register</h2>
                    
                    {% if success_message %}
                        <div class="alert alert-success mb-3" role="alert">
                            {{ success_message }}
                        </div>
                    {% endif %}
                    
                    <form action="/register" method="POST">
                        {{ form.hidden_tag() }}
                        <div class="mb-3">
                            {{ form.username(class="form-control", placeholder="Username") }}
                            {{ form.email(class="form-control", placeholder="Email", id="email_field") }}
                            {{ form.password(class="form-control", placeholder="Password") }}
                            {{ form.school_university(class="form-control", placeholder="School/University Name", id="university_field") }}
                            {{ form.submit(class="btn btn-primary w-100") }}
                        </div>
                        <p class="text-center">Already have an account? <a href="/login">Login</a></p>
                    </form>
                    
                    <script>
                        // Auto-detect MMU university when email is entered
                        document.getElementById('email_field').addEventListener('input', function() {
                            const email = this.value.toLowerCase();
                            const universityField = document.getElementById('university_field');
                            
                            if (email.endsWith('@student.mmu.edu.my')) {
                                universityField.value = 'Multimedia University Malaysia';
                                universityField.readOnly = true;
                                universityField.style.backgroundColor = '#f8f9fa';
                                universityField.title = 'University automatically detected from MMU email';
                            } else {
                                universityField.readOnly = false;
                                universityField.style.backgroundColor = '';
                                universityField.title = '';
                            }
                        });
                    </script>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}